# ==================== Kome API 配置 ====================
# 生产环境通过环境变量配置敏感信息
# 首次启动时访问 /setup 页面初始化管理员账户

spring:
  application:
    name: kome-api

  # 环境配置（默认使用 default，开发时使用 dev）
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:default}

  # 数据库配置
  datasource:
    url: jdbc:mysql://${DB_HOST}:${DB_PORT:3306}/${DB_NAME}?serverTimezone=Asia/Shanghai
    username: ${DB_USER}
    password: ${DB_PASSWORD}

  # Flyway 数据库迁移
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true    # 已有数据库时自动设置基线
    validate-on-migrate: true    # 迁移前验证脚本

# 服务端口
server:
  port: ${SERVER_PORT:8080}

# JWT 认证配置
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION:259200000}  # 默认 3 天

# MyBatis-Plus 配置
mybatis-plus:
  mapper-locations: classpath:/mapper/**/*.xml

# API 文档配置（生产环境默认关闭，开发环境通过 application-dev.yaml 开启）
springdoc:
  api-docs:
    enabled: false
  swagger-ui:
    enabled: false

# 健康检查端点
management:
  endpoints:
    web:
      exposure:
        include: health
  endpoint:
    health:
      show-details: never

# AI 配置（后端代理调用 OpenAI 兼容 API）
ai:
  api-key: ${AI_API_KEY:}
  base-url: ${AI_BASE_URL:https://api.openai.com}
  model: ${AI_MODEL:gpt-4o-mini}
  timeout: ${AI_TIMEOUT:30}
